# Simulation in R

In this module we will build our first business simulation model using R. We will start by identifying and establishing the model structure in R. We will then simulate the output of the model several times so that our outcome is robust. Finally, we will modify some of the models inputs, so that we can get an idea of how changing factors in the environment affect our outcome.

## Roll With It Sushi Needs Your Help

Renowned for serving the freshest sushi in the city, Roll With It Sushi is hosting a yellow-tail festival. Every morning, the Sous-Chef purchases fish at the market. Any unsold fish at the end of the day gets discarded. 

The restaurant has contacted you because they are unsure of how many people will attend the event and worry how this will impact their business financially. To ensure they have enough sushi and budget appropriately, they want to estimate the total cost and amount of sushi needed. Based on past events, they expect at least 20 people to attend and have the capacity to seat up to 50 guests. They anticipate the most likely attendance to be around 30 people.

Roll With It Sushi can purchase any quantity of yellow-tail from the fresh market at 9 dollars for 16 ounces (which is divisible). Each guest at the festival is entitled to 5 ounces of sushi. If the sushi runs out, some customers will not be happy. However, the restaurant has promised to serve their famous Miso soup to every attendee. The cost of making the soup for 50 guests is 300 dollars. Given that the festival charges 20 dollars per entry, how much yellow-tail would you recommend Sushi X purchase to maximize expected profits?

## Model Framework

There is alot of information provided by the restaurant and our task is to take that information and organize/classify in such a way that we can create a simulation model. In general, the information can be classified in following parts:

-   The **inputs** have given fixed values, at least for the purposes of the model.

-   The **decision variables** are those a decision maker controls.

-   The **calculated values** transform inputs and decision variables to other values that are helpful in describing our model.

-   The **outputs** are the ultimate values of interest; they are determined by the inputs, decision variables and/or the calculated values. Below, you can see how we can add this into R.

```{r}
library(extraDistr)
Order_Oz<-160 # Decision Variable

Price_Fish_Oz<-9/16 # Input
Price_Miso<-300 # Input
Entry_Fee<-20 # Input
Fish_Entitled_Oz<-5 #Input

Attendance<-round(rtriang(1,20,50,30),0) # Random Variable
Consumption<-Attendance*Fish_Entitled_Oz # Calculated 

Profit<-Entry_Fee*Attendance-Order_Oz*Price_Fish_Oz-Price_Miso #Outcome

```

Note the use of the extradistr package. The rtriang. How the inputs create a framework. The decision variable change to see how it affects the output. Discuss if some inputs are changeable.

## Law of Large Numbers

Above we have run the simulation once. The problem with this is that this is just one state of the world, and it is not really describing the set o possible outcomes. We want to provide the restaurant with a set of eventualities. Worst case scenarios, bets case scenarios, most likely outcomes for their decision. 

Additionally, if we provide an average we want to make sure that the average is not biased. The law of large numbers is a statistical principle that states that as the sample size of a study increases, the average of the sample will converge towards the true population mean. In other words, as the number of observations increases, the estimate of the population mean becomes more and more accurate.

The code below repeats the simulation not once, or twice, but several times. Although, there is not a set number of times one should run a simulation to get a good estimate of the mean (or distribution), computers are powerful enough to run thousands if not millions of simulations. Below we run the simulation 100 times for illustration.

```{r}
n<-100
V_Order_Oz<-rep(Order_Oz,n)
V_Price_Fish_Oz<-rep(Price_Fish_Oz,n)
V_Price_Miso<-rep(Price_Miso,n)
V_Entry_Fee<-rep(Entry_Fee,n)
V_Fish_Entitled_Oz<-rep(Fish_Entitled_Oz,n)

V_Attendance<-round(rtriang(n,20,50,30),0) # Random Variable
Consumption<-V_Attendance*V_Fish_Entitled_Oz # Calculated 

V_Profit<-V_Entry_Fee*V_Attendance-V_Order_Oz*V_Price_Fish_Oz-V_Price_Miso

mean(V_Profit)
```

## The Flaw of Averages

The flaw of averages, also known as the "law of averages fallacy," is the idea that the average value of a particular characteristic in a population can be used to represent the value of that characteristic for individual members of the population. This is often not the case because the average value can be misleading and does not take into account the variability and distribution of the characteristic within the population. For example, if a group of people has an average height of 5'10", it does not mean that every individual in the group is exactly 5'10" tall. Some people may be shorter, while others may be taller. The flaw of averages can lead to inaccurate assumptions and incorrect conclusions, particularly when making predictions or decisions based on the average value. It is important to consider the distribution and variability of the characteristic within the population when making predictions or decisions, rather than relying solely on the average value.

## The Newsvendor Problem

The news vendor problem is a classic decision-making problem in operations research and economics that involves deciding how much of a product to order and at what price to sell it. The problem is called the "news vendor" problem because it was originally used to model the decision-making process of a newspaper vendor trying to decide how many copies of a newspaper to order and at what price to sell them. In the news vendor problem, there are two main factors that influence the decision: the demand for the product and the cost of the product. The demand for the product is uncertain, as it depends on various factors such as the weather, the competition, and the price of the product. The cost of the product is also uncertain, as it may vary based on factors such as production costs, transportation costs, and discounts. The goal of the news vendor is to maximize profits by ordering the optimal amount of the product and setting the optimal price. The news vendor must make this decision based on incomplete information about the demand and cost of the product, which makes the problem challenging and requires the use of probabilistic models and optimization techniques.

## Sensitivity Analysis

Sensitivity analysis is a tool used in decision-making to assess the robustness of a model or decision by evaluating the impact of changes in certain key input variables on the output of the model or decision. Sensitivity analysis helps to identify which variables are most important and how sensitive the output is to changes in those variables. It is often used in financial, economic, and engineering contexts to evaluate the feasibility and risk of different scenarios or to identify potential areas of improvement.

There are several types of sensitivity analysis, including one-way sensitivity analysis, which involves varying one input variable at a time while holding all other variables constant, and two-way sensitivity analysis, which involves varying two input variables simultaneously. Sensitivity analysis can also be used to evaluate the uncertainty of the output by analyzing the range of possible outcomes given different assumptions about the input variables.

Sensitivity analysis is a useful tool for decision-makers because it helps to identify the key drivers of the model or decision and allows for a more informed and comprehensive analysis of the potential risks and benefits. However, it is important to note that sensitivity analysis is only as reliable as the assumptions and data used in the model, and it should be used in conjunction with other tools and techniques to provide a more complete understanding of the problem at hand.
